Workaround for https://github.com/cython/cython/pull/6755

See: https://github.com/void-linux/void-packages/pull/58320#issuecomment-3857442889

This should fix https://github.com/sagemath/sage/issues/39872#issuecomment-3737708338

--- a/src/sage/config.py.in
+++ b/src/sage/config.py.in
@@ -11,6 +11,7 @@ VERSION = "@PACKAGE_VERSION@"
 # to it.
 SAGE_LOCAL = "@prefix@"
 SAGE_ROOT = "@SAGE_ROOT@"
+SAGE_BUILD_SRC = "@EDITABLE_SRC@/src"
 
 # The semicolon-separated list of GAP root paths. This is the list of
 # locations that are searched for GAP packages. This is passed directly
--- a/src/sage/misc/sageinspect.py
+++ b/src/sage/misc/sageinspect.py
@@ -270,6 +270,14 @@ def _extract_embedded_position(docstring):
         return None
 
     raw_filename = res.group('FILENAME')
+
+    # remove SAGE_BUILD_SRC prefix to workaround
+    # https://github.com/cython/cython/pull/6755
+    from sage.config import SAGE_BUILD_SRC
+    from os.path import commonprefix, relpath
+    if commonprefix([raw_filename, SAGE_BUILD_SRC]) == SAGE_BUILD_SRC:
+        raw_filename = relpath(raw_filename, SAGE_BUILD_SRC)
+
     filename = raw_filename
 
     if not os.path.isabs(filename):
